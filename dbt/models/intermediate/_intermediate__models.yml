version: 2

models:
  - name: int_user_cohorts
    description: "User cohort assignments based on first bridge"
    columns:
      - name: user_address
        description: "Primary key - one row per user"
        tests:
          - unique
          - not_null
      - name: cohort_month
        tests:
          - not_null
      - name: total_bridged_eth
        tests:
          - not_null

  - name: int_user_segments
    description: "User segmentation (Whale vs Retail)"
    columns:
      - name: user_address
        tests:
          - unique
          - not_null
      - name: user_segment
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['Whale', 'Retail']
      - name: user_tier
        tests:
          - not_null

  - name: int_monthly_activity
    description: "User activity aggregated by month"
    tests:
      - unique:
          column_name: "user_address || '-' || activity_month"
    columns:
      - name: user_address
        tests:
          - not_null
      - name: activity_month
        tests:
          - not_null
      - name: transaction_count
        tests:
          - not_null
      - name: activity_level
        tests:
          - accepted_values:
              arguments:
                values: ['Power User', 'Active', 'Casual', 'Minimal']
